<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/biblio">

 <html>
  <head>
  	<meta charset="UTF-8"/>
  </head>
  <body>
 	 <h1>Liste des livres empruntÃ©s</h1>
 	 
 	 <table border="1" cellpadding="5">
  	 	<tr>
  	 		<th>Titre</th>
  	 		<th>Lieu</th>
  	 		<th>Auteur(s)</th>
  	 		<th>Editeur</th>
  	 		<th>Nombre d'emprunts</th>
  	 	</tr>
  	 	<!-- pour chaque livre qui n'apparait pas dans les livres empruntes -->
  	 	<xsl:for-each select="livres/livre[ref=//emprunts/emprunt/refLivre]">
  	 		<xsl:variable name="ISBN" select="ref"/>
  	 		<tr>
  				<td><xsl:value-of select="titre"/></td>
  				<td><xsl:value-of select="@lieu"/></td>
  				<td><xsl:value-of select="auteur"/></td>
  				<td><xsl:value-of select="editeur"/></td>
  				<!-- on compte le nombre d'occurrences dans la liste des livres empruntes -->
  				<td><xsl:value-of select="count(//emprunt[refLivre=$ISBN])"/></td>
  			</tr>
  	 	</xsl:for-each>
  	 </table>
  </body>
 </html>
</xsl:template>
</xsl:stylesheet>


